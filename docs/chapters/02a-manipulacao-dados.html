<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Artur Damião">

<title>5&nbsp; Aprendendo a manipular dados – Análise de dados criminais usando linguagem R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/03-importando-dados.html" rel="next">
<link href="../chapters/02-conhecendo-o-R.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>


<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo_en.png" alt="" class="navbar-logo light-content">
    <img src="../logo_en.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Análise de dados criminais usando linguagem R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-materiais" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Materiais</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-materiais">    
        <li>
    <a class="dropdown-item" href="https://youtube.com/playlist?list=PLInYN7O8R1DRcWN5pRvZfrG65RgtP1OB1&amp;si=_Izok__wwjtfNpVH"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Introdução à Programação para Humanidades</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.youtube.com/playlist?list=PLInYN7O8R1DQnnLGNt6udOCpGoH3E7un1"><i class="bi bi-youtube" role="img">
</i> 
 <span class="dropdown-text">Análise de dados criminais usando linguagem R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ipeadata-lab.github.io/curso_r_intro_202409/"><i class="bi bi-pencil" role="img">
</i> 
 <span class="dropdown-text">[IPEA] Introdução à análise de dados no R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Slides</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../slides/01-apresentacao.html"><i class="bi bi-display" role="img">
</i> 
 <span class="dropdown-text">Slides Aula 01</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/playlist?list=PLInYN7O8R1DQnnLGNt6udOCpGoH3E7un1"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/arturdamiao/2026-02-summer-intro-crime-analysis-R" title="Código fonte" class="quarto-navigation-tool px-1" aria-label="Código fonte"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introducao.html">Como analisar dados criminais?</a></li><li class="breadcrumb-item"><a href="../chapters/02a-manipulacao-dados.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aprendendo a manipular dados</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Pré-curso</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Análise de dados criminais usando linguagem R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/instalacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Instalação dos softwares</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Como analisar dados criminais?</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introducao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Definições</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-conhecendo-o-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conhecendo o <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02a-manipulacao-dados.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aprendendo a manipular dados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">O caso de São Paulo</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-importando-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analisando dados da Secretaria de Segurança Pública</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#importando-os-pacotes-no-r" id="toc-importando-os-pacotes-no-r" class="nav-link active" data-scroll-target="#importando-os-pacotes-no-r"><span class="header-section-number">5.1</span> Importando os pacotes no <code>R</code></a></li>
  <li><a href="#ambientação-e-importação-de-pacotes" id="toc-ambientação-e-importação-de-pacotes" class="nav-link" data-scroll-target="#ambientação-e-importação-de-pacotes"><span class="header-section-number">6</span> Ambientação e importação de pacotes</a></li>
  <li><a href="#estatística-descritiva-e-manipulação-de-dados" id="toc-estatística-descritiva-e-manipulação-de-dados" class="nav-link" data-scroll-target="#estatística-descritiva-e-manipulação-de-dados"><span class="header-section-number">7</span> Estatística descritiva e manipulação de dados</a>
  <ul>
  <li><a href="#utilizando-o-r-base" id="toc-utilizando-o-r-base" class="nav-link" data-scroll-target="#utilizando-o-r-base"><span class="header-section-number">7.1</span> Utilizando o R Base</a></li>
  <li><a href="#operadores-lógicos" id="toc-operadores-lógicos" class="nav-link" data-scroll-target="#operadores-lógicos"><span class="header-section-number">7.2</span> Operadores lógicos</a></li>
  <li><a href="#encadeando-funções-com-o-operador-pipe" id="toc-encadeando-funções-com-o-operador-pipe" class="nav-link" data-scroll-target="#encadeando-funções-com-o-operador-pipe"><span class="header-section-number">7.3</span> Encadeando funções com o operador pipe <code>|&gt;</code></a></li>
  <li><a href="#conhecendo-o-pacote-dplyr" id="toc-conhecendo-o-pacote-dplyr" class="nav-link" data-scroll-target="#conhecendo-o-pacote-dplyr"><span class="header-section-number">7.4</span> Conhecendo o pacote <code>{dplyr}</code></a>
  <ul>
  <li><a href="#filtrando-nas" id="toc-filtrando-nas" class="nav-link" data-scroll-target="#filtrando-nas"><span class="header-section-number">7.4.1</span> Filtrando <code>NAs</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#usando-o-dataset-gasoline" id="toc-usando-o-dataset-gasoline" class="nav-link" data-scroll-target="#usando-o-dataset-gasoline"><span class="header-section-number">8</span> Usando o dataset <code>Gasoline</code></a>
  <ul>
  <li><a href="#usando-a-função-select" id="toc-usando-a-função-select" class="nav-link" data-scroll-target="#usando-a-função-select"><span class="header-section-number">8.1</span> Usando a função <code>select()</code></a></li>
  <li><a href="#agrupando-informações-com-group_by" id="toc-agrupando-informações-com-group_by" class="nav-link" data-scroll-target="#agrupando-informações-com-group_by"><span class="header-section-number">8.2</span> Agrupando informações com <code>group_by()</code></a></li>
  <li><a href="#resumir-estatísticas-com-summarise" id="toc-resumir-estatísticas-com-summarise" class="nav-link" data-scroll-target="#resumir-estatísticas-com-summarise"><span class="header-section-number">8.3</span> Resumir estatísticas com <code>summarise()</code></a></li>
  <li><a href="#adicionando-colunas-com-o-mutate-e-transmute" id="toc-adicionando-colunas-com-o-mutate-e-transmute" class="nav-link" data-scroll-target="#adicionando-colunas-com-o-mutate-e-transmute"><span class="header-section-number">8.4</span> Adicionando colunas com o <code>mutate()</code> e <code>transmute()</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introducao.html">Como analisar dados criminais?</a></li><li class="breadcrumb-item"><a href="../chapters/02a-manipulacao-dados.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aprendendo a manipular dados</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aprendendo a manipular dados</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autor</div>
  <div class="quarto-title-meta-heading">Afiliação</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.arturdamiao.com/">Artur Damião</a> <a href="mailto:arturcardoso@usp.br" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-8628-1653" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Programa de Pós-Graduação em Sociologia (USP)
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Data de Publicação</div>
    <div class="quarto-title-meta-contents">
      <p class="date">3 de fevereiro de 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Dentro do <code>R</code>, existem inúmeras formas de se importar um conjunto de dados. Os dados podem ter os mais diversos formatos (extensões):</p>
<ul>
<li><code>csv</code>, <em>comma separated values</em>;</li>
<li><code>xlsx</code>, formato do Excel (ao baixar a planilha);</li>
<li><code>rds</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, formato nativo do <code>R</code>;</li>
<li><code>parquet</code>;</li>
<li>muito mais!</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;É a forma mais recomendada, ao meu ver, de salvar objetos dentro do <code>R</code>. Um diferencial do <code>.rds</code> é que ele mantém a estrutura do objeto: ou seja, os atributos permanecem os mesmos.</p></div></div><section id="importando-os-pacotes-no-r" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="importando-os-pacotes-no-r"><span class="header-section-number">5.1</span> Importando os pacotes no <code>R</code></h2>
<p>Como vimos, a primeira coisa a se fazer dentro de um script no <code>R</code> é fazer a importação dos pacotes (ou bibliotecas).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um pacote é uma “caixa de ferramentas” extra que você instala no <code>R</code> para ganhar novas funcionalidades. Ele reúne códigos, dados e documentação em um único lugar. O termo biblioteca (library) refere-se ao local (a pasta no seu computador) onde esses pacotes ficam guardados.</p>
</div>
</div>
<p>Geralmente, precisamos, primeiramente, instalar um pacote com a função <code>install.packages</code> e então “carregá-lo” para nosso ambiente, com a função <code>library</code>. Carregar um pacote significa, basicamente, dizer ao <code>R</code> que queremos utilizar um conjunto de ferramentas na nossa sessão. Dito isso:</p>
<ol type="1">
<li>Sempre instala-se um pacote novo. Este processo só é feito uma vez, ou seja, utiliza-se a função <code>install.packages</code> apenas quando ainda não possuímos o pacote em nossa máquina.</li>
<li>Após a primeira instalação, só é necessário instalar um pacote novamente caso ele tenha sido atualizado (lembra que a comunidade é ativa?). Caso não seja o caso, só é necessário “carregar” nosso pacote para a sessão.</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Você pode ter notado que não utilizei as aspas (““) com a função <code>library</code>. Isso é opcional, você pode ou não utilizá-las.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Dica</span>Dica 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>O pacote <code>pacman</code> permite que você faça, ao mesmo tempo, a instalação e o carregamento do pacote, com a função <code>p_load</code>. Ao invés de fazer, por exemplo:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>você pode fazer apenas:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Isso é particularmente útil quando você precisa importar muitos pacotes!</p>
</div>
</div>
<p>Caso você se esqueça de importar algum pacote, não se preocupe! É possível utilizar uma função de um pacote específico (desde que você tenha ele baixado no seu computador) sem precisar utilizar o <code>library(nome_do_pacote)</code> no começo do seu script. Ao especificar o nome do pacote e utilizar <code>::</code>, como demonstrado na <a href="#fig-dica-doispontos" class="quarto-xref">Figura&nbsp;<span>5.1</span></a>, é possível acessar a função desejada:</p>
<div id="fig-dica-doispontos" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dica-doispontos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/dica_pacote_doispontos.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dica-doispontos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5.1: Usando uma função sem carregar o pacote
</figcaption>
</figure>
</div>
<p>Agora, basta carregamos os pacaotes de interesse</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              tidyverse, <span class="co"># pacotão com vários pacotes core </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              rio,       <span class="co"># pacote que facilita a leitura de qualquer formato</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              readxl,    <span class="co"># pacote para ler no formato .xlsx</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>              janitor    <span class="co"># pacote para limpeza de dados</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               )</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ambientação-e-importação-de-pacotes" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Ambientação e importação de pacotes</h1>
<p>Feito isso, precisamos importar o conjunto de dados a serem trabalhados no encontro de hoje. Inicialmente, vamos trabalhar com um banco de dados de personagens de <code>starwars</code>. Esse banco está “embutido” no pacote <code>dplyr</code>. São bases de dados para fins didáticos!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>starwars</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="estatística-descritiva-e-manipulação-de-dados" class="level1 page-columns page-full" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Estatística descritiva e manipulação de dados</h1>
<section id="utilizando-o-r-base" class="level2 page-columns page-full" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="utilizando-o-r-base"><span class="header-section-number">7.1</span> Utilizando o R Base</h2>
<p>Feita a importação dos dados, podemos visualizá-los com a função <code>head()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dados)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue            19   male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
3 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
4 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
6 Owen Lars    178   120 brown, gr… light      blue            52   male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>É possível, também, especificar quantas linhas queremos ver. Por exemplo, as 3 primeiras linhas:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dados, <span class="dv">3</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Luke Sky…    172    77 blond      fair       blue              19 male  mascu…
2 C-3PO        167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
3 R2-D2         96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>Se eu quiser saber quais são as últimas linhas do meu banco de dados, posso usar a função <code>tail()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(dados)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Tion Med…    206    80 none       grey       black             NA male  mascu…
2 Finn          NA    NA black      dark       dark              NA male  mascu…
3 Rey           NA    NA brown      light      hazel             NA fema… femin…
4 Poe Dame…     NA    NA brown      light      brown             NA male  mascu…
5 BB8           NA    NA none       none       black             NA none  mascu…
6 Captain …     NA    NA none       none       unknown           NA fema… femin…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>Para acessar alguma coluna dentro do meu objeto <code>dados</code>, basta usar o <code>$</code>. Com o <code>$</code>, posso usar a função <code>mean()</code> para saber a média de alguma variável de interesse:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dados<span class="sc">$</span>height)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Recebemos uma resposta estranha: <code>NA</code>. Existem 03 classes especiais de objetos:: <code>NA</code>, <code>NULL</code> e <code>NaN</code>. <code>NULL</code> significa que eu estou tentando acessar um elemento que não existe, logo, ele é <em>nulo</em>. <code>NaN</code> significa “Not a Number”, que é autoexplicativo<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Já o <code>NA</code> significa “Not Available”, ou seja, não está disponível. O <code>NA</code> geralmente acontece quando fazemos medidas descritivas, como a média, e o nosso conjunto de dados tem algum valor faltante. Para contornar esse problema, usamos a seguinte opção dentro da função <code>mean</code>:</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Se eu tento dividir 0 por 0, por exemplo, o resultado é <code>NaN</code>.</p></div></div><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dados<span class="sc">$</span>height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 174.6049</code></pre>
</div>
</div>
<p><code>na.rm</code> significa, basicamente, “na remove”. Ou seja, remover os valores ausentes. Assim, consigo ver a média da altura dos personagens de Star Wars.</p>
<p>Também posso analisar o <strong>desvio padrão</strong> da altura dos personagens. O desvio padrão é uma medida de dispersão que mostra, em média, quanto os valores se distanciam da média de uma variável.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dados<span class="sc">$</span>height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.77416</code></pre>
</div>
</div>
</section>
<section id="operadores-lógicos" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="operadores-lógicos"><span class="header-section-number">7.2</span> Operadores lógicos</h2>
<table class="caption-top table">
<caption>Operadores lógicos no <code>R</code></caption>
<thead>
<tr class="header">
<th>Operador</th>
<th style="text-align: left;">Operação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>!</code></td>
<td style="text-align: left;">Negação (não)</td>
</tr>
<tr class="even">
<td><code>&amp;</code></td>
<td style="text-align: left;">E (avalia elemento a elemento)</td>
</tr>
<tr class="odd">
<td><code>|</code></td>
<td style="text-align: left;">Ou (avalia elemento a elemento)</td>
</tr>
<tr class="even">
<td><code>&lt;</code></td>
<td style="text-align: left;">Menor</td>
</tr>
<tr class="odd">
<td><code>&lt;=</code></td>
<td style="text-align: left;">Menor ou igual</td>
</tr>
<tr class="even">
<td><code>&gt;</code></td>
<td style="text-align: left;">Maior</td>
</tr>
<tr class="odd">
<td><code>&gt;=</code></td>
<td style="text-align: left;">Maior ou igual</td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td style="text-align: left;">Diferente</td>
</tr>
<tr class="odd">
<td><code>&amp;&amp;</code></td>
<td style="text-align: left;">E (avalia apenas o 1º elemento)</td>
</tr>
<tr class="even">
<td><code>||</code></td>
<td style="text-align: left;">Ou (avalia apenas o 1º elemento)</td>
</tr>
</tbody>
</table>
<p>Operadores lógicos no R são símbolos usados para fazer comparações e testar condições, retornando valores TRUE ou FALSE. É muito comum utilizarmos eles em filtros. Às vezes, queremos filtrar resultados dado uma condição específica. Veremos isso mais à frente.</p>
</section>
<section id="encadeando-funções-com-o-operador-pipe" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="encadeando-funções-com-o-operador-pipe"><span class="header-section-number">7.3</span> Encadeando funções com o operador pipe <code>|&gt;</code></h2>
<p>René Magritte tem uma pintura icônica, que inspirou um pacote no <code>R</code>. O pacote é chamado de <code>{magrittr}</code> e ele basicamente nos apresenta um conceito fantástico: o operador pipe. Basicamente, o pipe pega o lado esquerdo do seu código e alimenta o lado direito, encadeando as funções que você for utilizar.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://modern-rstats.eu/assets/pas_une_pipe.png" class="img-fluid figure-img"></p>
<figcaption>La trahison des images</figcaption>
</figure>
</div>
<p>Esse conceito ficará mais claro adiante, mas é importante saber da existência dele. Sempre que virmos um <code>|&gt;</code> no nosso código, leremos ele como um “e então”. Pode ser que o pipe apareça para você como <code>%&gt;%</code>, mas isso não faz muita diferença agora. O atalho para o operador pipe é <code>CTRL + SHIFT + M</code>.</p>
</section>
<section id="conhecendo-o-pacote-dplyr" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="conhecendo-o-pacote-dplyr"><span class="header-section-number">7.4</span> Conhecendo o pacote <code>{dplyr}</code></h2>
<p>O <code>{dplyr}</code> é um dos principais pacotes do <code>{tidyverse}</code>, e é nele que passaremos a maior parte do tempo. Isso porque, quando trabalhamos com dados, a maior parte da energia que gastamos é em “limpar” os dados. O <code>{dplyr}</code> tem alguns “verbos” que são os mais utilizados. Vamos conhecê-los.</p>
<p>Se quiser, por exemplo, verificar a <strong>média da altura</strong> dos personagens de Star Wars por <strong>sexo</strong>, podemos fazer da seguinte forma:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex            media_altura
  &lt;chr&gt;                 &lt;dbl&gt;
1 female                 172.
2 hermaphroditic         175 
3 male                   179.
4 none                   131.
5 &lt;NA&gt;                   175 </code></pre>
</div>
</div>
<p>Lemos essa operação da seguinte forma: <em>“pegue o objeto dados, <strong>e então</strong> agrupe-o por sexo, <strong>e então</strong> calcule a média para cada subgrupo, omitindo os valores ausentes”</em>.</p>
<p>Sem o operador <code>|&gt;</code>, teríamos de escrever o código da seguinte forma:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="fu">group_by</span>(dados, sex), <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  sex            `mean(height, na.rm = TRUE)`
  &lt;chr&gt;                                 &lt;dbl&gt;
1 female                                 172.
2 hermaphroditic                         175 
3 male                                   179.
4 none                                   131.
5 &lt;NA&gt;                                   175 </code></pre>
</div>
</div>
<p>Concordamos que o <code>|&gt;</code> é uma mão na roda, né?</p>
<p>Ainda, é possível <strong>filtrar</strong> informações de interesse primeiro. Por exemplo, se eu quero filtrar a altura de personagens cujo gênero é “masculine”, basta inserirmos a função <code>filter()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"masculine"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  sex            media_altura
  &lt;chr&gt;                 &lt;dbl&gt;
1 hermaphroditic         175 
2 male                   179.
3 none                   140 </code></pre>
</div>
</div>
<p>Lemos essa operação da seguinte forma: <em>“pegue o objeto dados, <strong>e então</strong> filtre as ocorrências cuja variável <code>gender</code> seja igual a”masculine”, <strong>e então</strong> agrupe-o por sexo, <strong>e então</strong> calcule a média para cada subgrupo, omitindo os valores ausentes”</em>.</p>
<p>Se precisarmos de mais medidas para além da média da altura, podemos adicionar várias funções conforme precisarmos:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tabela_descritiva <span class="ot">&lt;-</span> dados <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">variancia_altura =</span> <span class="fu">var</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">desvio_altura =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">n</span>()) <span class="co"># número de observações</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>tabela_descritiva</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  sex            media_altura variancia_altura desvio_altura n_obs
  &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
1 female                 172.             253.          15.9    16
2 hermaphroditic         175               NA           NA       1
3 male                   179.            1297.          36.0    60
4 none                   131.            2416.          49.1     6
5 &lt;NA&gt;                   175              153.          12.4     4</code></pre>
</div>
</div>
<p>A função <code>var()</code> me dá a variância da altura e a função <code>n()</code> me retorna o número de observações. Na nossa tabela descritiva, vimos que temos um grupo com apenas 01 indivíduo. Se quisermos, por exemplo, analisar os sexos que tem mais de um indivíduo, podemos filtrar:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tabela_descritiva2 <span class="ot">&lt;-</span> tabela_descritiva <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_obs <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>tabela_descritiva2</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  sex    media_altura variancia_altura desvio_altura n_obs
  &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
1 female         172.             253.          15.9    16
2 male           179.            1297.          36.0    60
3 none           131.            2416.          49.1     6
4 &lt;NA&gt;           175              153.          12.4     4</code></pre>
</div>
</div>
<section id="filtrando-nas" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="filtrando-nas"><span class="header-section-number">7.4.1</span> Filtrando <code>NAs</code></h3>
<p>É um pouco cansativo ficar utilizando o argumento <code>na.rm = TRUE</code> o tempo todo para filtrar os NAs a cada operação. Antes de eliminarmos quaisquer valores ausentes, é preciso conhecer nosso banco de dados para tomar esta decisão. Isso porque, como alguns cientistas sociais dizem, um <strong>não dado</strong> também é <strong>dado</strong>! Muitos valores ausentes podem indicar, por exemplo, como as pessoas estão registrando (no caso, deixando de registrar) as ocorrências. Muitos <code>NAs</code> pode ser sinal de mal preenchimento de informações.</p>
<p>Voltando para nosso conjunto de dados, vamos ver quantas linhas temos na coluna <code>sex</code> que são <code>NA</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(sex))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Jek Tono…    180   110 brown      fair       blue              NA &lt;NA&gt;  &lt;NA&gt;  
2 Gregar T…    185    85 black      dark       brown             NA &lt;NA&gt;  &lt;NA&gt;  
3 Cordé        157    NA brown      light      brown             NA &lt;NA&gt;  &lt;NA&gt;  
4 Sly Moore    178    48 none       pale       white             NA &lt;NA&gt;  &lt;NA&gt;  
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<p>São apenas 04 linhas. Podemos ignorálas. Refazendo a análise da primeira tabela descritiva:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">variancia_altura =</span> <span class="fu">var</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">desvio_altura =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_obs <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  sex    media_altura variancia_altura desvio_altura n_obs
  &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
1 female         172.             253.          15.9    16
2 male           179.            1297.          36.0    60
3 none           131.            2416.          49.1     6</code></pre>
</div>
</div>
<p>E se quisermos adicionar outra variável ao nosso grupo?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, eye_color) <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_altura =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">variancia_altura =</span> <span class="fu">var</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">desvio_altura =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n_obs <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'sex'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
# Groups:   sex [3]
   sex    eye_color media_altura variancia_altura desvio_altura n_obs
   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;int&gt;
 1 female black             196.            612.         24.7       2
 2 female blue              167             118.         10.9       6
 3 female brown             166.            209.         14.5       4
 4 female hazel             178              NA          NA         2
 5 male   black             182            1197          34.6       7
 6 male   blue              190             429.         20.7      12
 7 male   brown             167.           1657.         40.7      15
 8 male   orange            181.           1306.         36.1       7
 9 male   red               190.              0.5         0.707     2
10 male   unknown           136            6498          80.6       2
11 male   yellow            180.           2196.         46.9       9
12 none   red               131            3571          59.8       3</code></pre>
</div>
</div>
<p>Para essa primeira parte, está suficiente. Conhecemos as funções <code>filter()</code>, <code>group_by()</code> e <code>summarise()</code> do pacote <code>{dplyr}</code>.</p>
</section>
</section>
</section>
<section id="usando-o-dataset-gasoline" class="level1 page-columns page-full" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Usando o dataset <code>Gasoline</code></h1>
<p>Primeiro, precisamos instalar o pacote <code>plm</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"plm"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Agora, vamos carregar os dados que estão dentro do pacote:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Gasoline, <span class="at">package =</span> <span class="st">"plm"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Este conjunto de dados nos dá informações sobre consumo de gasolina para 18 países, entre 1960 e 1978. As variáveis são:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 87%">
</colgroup>
<thead>
<tr class="header">
<th>Variável</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>country</td>
<td>Fator com 18 níveis (países)</td>
</tr>
<tr class="even">
<td>year</td>
<td>Ano</td>
</tr>
<tr class="odd">
<td>lgaspcar</td>
<td>Logaritmo do consumo de gasolina por carro</td>
</tr>
<tr class="even">
<td>lincomep</td>
<td>Logaritmo da renda real per capita</td>
</tr>
<tr class="odd">
<td>lrpmg</td>
<td>Logaritmo do preço real da gasolina</td>
</tr>
<tr class="even">
<td>lcarpcap</td>
<td>Logaritmo do estoque de carros per capita</td>
</tr>
</tbody>
</table>
<p>Quando carregamos este conjunto de dados, ele pertence à uma classe chamada <code>data.frame</code>. O <code>R</code> possui uma classe diferente e especial para conjunto de dados, que apresenta um melhor “print” no console, chamada <code>tibble</code>. Para convertemos este conjunto de dados (no formato <code>data.frame</code>) para <code>tibble</code>, executamos a seguinte operação:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Gasoline)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Adicionalmente, quero deixar todas os países da coluna <code>country</code> com letras minúsculas. Para isso:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="ot">&lt;-</span> gasoline <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">tolower</span>(country))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>E se eu quiser filtrar os dados somente para o ano de 1972? Muito simples com a função <code>filter()</code>, sem utilizar o <code>|&gt;</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gasoline, year <span class="sc">==</span> <span class="dv">1972</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
   country   year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria   1972     4.13    -5.98 -0.596    -8.54
 2 belgium   1972     3.91    -5.71 -0.311    -8.36
 3 canada    1972     4.89    -5.44 -1.10     -7.99
 4 denmark   1972     4.08    -5.65 -0.499    -8.33
 5 france    1972     3.85    -5.70 -0.408    -8.22
 6 germany   1972     3.93    -5.72 -0.718    -8.24
 7 greece    1972     4.80    -6.35 -0.120   -10.3 
 8 ireland   1972     4.27    -6.31 -0.424    -8.82
 9 italy     1972     3.63    -6.21 -0.215    -8.38
10 japan     1972     4.22    -5.93 -0.521    -9.05
11 netherla  1972     3.92    -5.79 -0.319    -8.38
12 norway    1972     4.08    -5.66 -0.260    -8.51
13 spain     1972     3.89    -5.46  0.537    -9.27
14 sweden    1972     3.98    -7.74 -2.77     -8.10
15 switzerl  1972     4.26    -5.81 -0.940    -8.30
16 turkey    1972     5.58    -7.08 -0.546   -12.2 
17 u.k.      1972     3.99    -5.97 -0.528    -8.36
18 u.s.a.    1972     4.85    -5.35 -1.33     -7.68</code></pre>
</div>
</div>
<p>Mas, é bom nos acostumarmos com o operador pipe, portanto:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1972</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
   country   year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria   1972     4.13    -5.98 -0.596    -8.54
 2 belgium   1972     3.91    -5.71 -0.311    -8.36
 3 canada    1972     4.89    -5.44 -1.10     -7.99
 4 denmark   1972     4.08    -5.65 -0.499    -8.33
 5 france    1972     3.85    -5.70 -0.408    -8.22
 6 germany   1972     3.93    -5.72 -0.718    -8.24
 7 greece    1972     4.80    -6.35 -0.120   -10.3 
 8 ireland   1972     4.27    -6.31 -0.424    -8.82
 9 italy     1972     3.63    -6.21 -0.215    -8.38
10 japan     1972     4.22    -5.93 -0.521    -9.05
11 netherla  1972     3.92    -5.79 -0.319    -8.38
12 norway    1972     4.08    -5.66 -0.260    -8.51
13 spain     1972     3.89    -5.46  0.537    -9.27
14 sweden    1972     3.98    -7.74 -2.77     -8.10
15 switzerl  1972     4.26    -5.81 -0.940    -8.30
16 turkey    1972     5.58    -7.08 -0.546   -12.2 
17 u.k.      1972     3.99    -5.97 -0.528    -8.36
18 u.s.a.    1972     4.85    -5.35 -1.33     -7.68</code></pre>
</div>
</div>
<p>Também é possível filtrar mais de uma condição. Para isso, podemos usar o operador <code>%in%</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1969</span>, <span class="dv">1973</span>)) <span class="co"># sequência de anos entre 1969 a 1973</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 6
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1969     4.05    -6.15 -0.559    -8.79
 2 austria  1970     4.08    -6.08 -0.597    -8.73
 3 austria  1971     4.11    -6.04 -0.654    -8.64
 4 austria  1972     4.13    -5.98 -0.596    -8.54
 5 austria  1973     4.20    -5.90 -0.594    -8.49
 6 belgium  1969     3.85    -5.86 -0.355    -8.52
 7 belgium  1970     3.87    -5.80 -0.378    -8.45
 8 belgium  1971     3.87    -5.76 -0.399    -8.41
 9 belgium  1972     3.91    -5.71 -0.311    -8.36
10 belgium  1973     3.90    -5.64 -0.373    -8.31
# ℹ 80 more rows</code></pre>
</div>
</div>
<p>Ou</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="dv">1969</span><span class="sc">:</span><span class="dv">1973</span>) <span class="co"># sem a função seq()</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 6
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1969     4.05    -6.15 -0.559    -8.79
 2 austria  1970     4.08    -6.08 -0.597    -8.73
 3 austria  1971     4.11    -6.04 -0.654    -8.64
 4 austria  1972     4.13    -5.98 -0.596    -8.54
 5 austria  1973     4.20    -5.90 -0.594    -8.49
 6 belgium  1969     3.85    -5.86 -0.355    -8.52
 7 belgium  1970     3.87    -5.80 -0.378    -8.45
 8 belgium  1971     3.87    -5.76 -0.399    -8.41
 9 belgium  1972     3.91    -5.71 -0.311    -8.36
10 belgium  1973     3.90    -5.64 -0.373    -8.31
# ℹ 80 more rows</code></pre>
</div>
</div>
<p>Ainda, é possível utilizar a função auxiliadora<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <code>between()</code>:</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Como o nome sugere, funções auxiliadores ajudam as funções principais. É importante notar que é possível usar funções dentro de funções.</p></div></div><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">1969</span>, <span class="dv">1973</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 6
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1969     4.05    -6.15 -0.559    -8.79
 2 austria  1970     4.08    -6.08 -0.597    -8.73
 3 austria  1971     4.11    -6.04 -0.654    -8.64
 4 austria  1972     4.13    -5.98 -0.596    -8.54
 5 austria  1973     4.20    -5.90 -0.594    -8.49
 6 belgium  1969     3.85    -5.86 -0.355    -8.52
 7 belgium  1970     3.87    -5.80 -0.378    -8.45
 8 belgium  1971     3.87    -5.76 -0.399    -8.41
 9 belgium  1972     3.91    -5.71 -0.311    -8.36
10 belgium  1973     3.90    -5.64 -0.373    -8.31
# ℹ 80 more rows</code></pre>
</div>
</div>
<p>Também é possível selecionar anos não consecutivos:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1969</span>, <span class="dv">1973</span>, <span class="dv">1977</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 6
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1969     4.05    -6.15 -0.559    -8.79
 2 austria  1973     4.20    -5.90 -0.594    -8.49
 3 austria  1977     3.93    -5.83 -0.422    -8.25
 4 belgium  1969     3.85    -5.86 -0.355    -8.52
 5 belgium  1973     3.90    -5.64 -0.373    -8.31
 6 belgium  1977     3.85    -5.56 -0.432    -8.14
 7 canada   1969     4.86    -5.56 -1.04     -8.10
 8 canada   1973     4.90    -5.41 -1.13     -7.94
 9 canada   1977     4.81    -5.34 -1.07     -7.77
10 denmark  1969     4.17    -5.72 -0.407    -8.47
# ℹ 44 more rows</code></pre>
</div>
</div>
<section id="usando-a-função-select" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="usando-a-função-select"><span class="header-section-number">8.1</span> Usando a função <code>select()</code></h2>
<p>Enquanto a função <code>filter()</code> é utilizada para manter ou descartar as linhas do nosso conjunto de dados, a função <code>select()</code> nos permite <strong>selecionar</strong> colunas inteiras.</p>
<p>Para manter colunas, podemos utilizar:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, lrpmg)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 3
   country  year  lrpmg
   &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt;
 1 austria  1960 -0.335
 2 austria  1961 -0.351
 3 austria  1962 -0.380
 4 austria  1963 -0.414
 5 austria  1964 -0.445
 6 austria  1965 -0.497
 7 austria  1966 -0.467
 8 austria  1967 -0.506
 9 austria  1968 -0.522
10 austria  1969 -0.559
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Para descartálas, utilizamos:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>country, <span class="sc">-</span>year, <span class="sc">-</span>lrpmg)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 3
   lgaspcar lincomep lcarpcap
      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     4.17    -6.47    -9.77
 2     4.10    -6.43    -9.61
 3     4.07    -6.41    -9.46
 4     4.06    -6.37    -9.34
 5     4.04    -6.32    -9.24
 6     4.03    -6.29    -9.12
 7     4.05    -6.25    -9.02
 8     4.05    -6.23    -8.93
 9     4.05    -6.21    -8.85
10     4.05    -6.15    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Ainda, é possível renomeá-las diretamente com a função <code>select()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, <span class="at">date =</span> year, lrpmg)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 3
   country  date  lrpmg
   &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt;
 1 austria  1960 -0.335
 2 austria  1961 -0.351
 3 austria  1962 -0.380
 4 austria  1963 -0.414
 5 austria  1964 -0.445
 6 austria  1965 -0.497
 7 austria  1966 -0.467
 8 austria  1967 -0.506
 9 austria  1968 -0.522
10 austria  1969 -0.559
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>A função <code>rename()</code> faz exatamente a mesma coisa. Entretanto, ele não faz nenhum tipo de seleção, apenas renomea a coluna de interesse.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> year)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 6
   country  date lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77
 2 austria  1961     4.10    -6.43 -0.351    -9.61
 3 austria  1962     4.07    -6.41 -0.380    -9.46
 4 austria  1963     4.06    -6.37 -0.414    -9.34
 5 austria  1964     4.04    -6.32 -0.445    -9.24
 6 austria  1965     4.03    -6.29 -0.497    -9.12
 7 austria  1966     4.05    -6.25 -0.467    -9.02
 8 austria  1967     4.05    -6.23 -0.506    -8.93
 9 austria  1968     4.05    -6.21 -0.522    -8.85
10 austria  1969     4.05    -6.15 -0.559    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>É possível utilizar a função <code>select()</code> para reordenar as colunas. Eu quero, por exemplo, que minhas três primeiras colunas do conjunto de dados sejam <code>year</code>, <code>country</code> e <code>lrpmg</code>, nesta ordem:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, country, lrpmg, <span class="fu">everything</span>())</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 6
    year country  lrpmg lgaspcar lincomep lcarpcap
   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  1960 austria -0.335     4.17    -6.47    -9.77
 2  1961 austria -0.351     4.10    -6.43    -9.61
 3  1962 austria -0.380     4.07    -6.41    -9.46
 4  1963 austria -0.414     4.06    -6.37    -9.34
 5  1964 austria -0.445     4.04    -6.32    -9.24
 6  1965 austria -0.497     4.03    -6.29    -9.12
 7  1966 austria -0.467     4.05    -6.25    -9.02
 8  1967 austria -0.506     4.05    -6.23    -8.93
 9  1968 austria -0.522     4.05    -6.21    -8.85
10  1969 austria -0.559     4.05    -6.15    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>A função <code>everything()</code> é uma função auxiliadora, como notamos. Ainda, existem outras funções, como por exemplo <code>starts_with</code> e <code>ends_with</code>. Se eu quiser, por exemplo, selecionar apenas as colunas cujo nome começam com “l”?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"l"</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 4
   lgaspcar lincomep  lrpmg lcarpcap
      &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1     4.17    -6.47 -0.335    -9.77
 2     4.10    -6.43 -0.351    -9.61
 3     4.07    -6.41 -0.380    -9.46
 4     4.06    -6.37 -0.414    -9.34
 5     4.04    -6.32 -0.445    -9.24
 6     4.03    -6.29 -0.497    -9.12
 7     4.05    -6.25 -0.467    -9.02
 8     4.05    -6.23 -0.506    -8.93
 9     4.05    -6.21 -0.522    -8.85
10     4.05    -6.15 -0.559    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p><code>ends_with</code> funciona de maneira similar, dá para pegar a ideia. Outra função auxiliadora interessante é a <code>contains()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, <span class="fu">contains</span>(<span class="st">"car"</span>))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 4
   country  year lgaspcar lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1960     4.17    -9.77
 2 austria  1961     4.10    -9.61
 3 austria  1962     4.07    -9.46
 4 austria  1963     4.06    -9.34
 5 austria  1964     4.04    -9.24
 6 austria  1965     4.03    -9.12
 7 austria  1966     4.05    -9.02
 8 austria  1967     4.05    -8.93
 9 austria  1968     4.05    -8.85
10 austria  1969     4.05    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>É possível encontrar uma lista de funções auxiliadoras na <a href="https://tidyselect.r-lib.org/reference/language.html">documentação</a> do pacote. A documentação é uma espécie de manual, onde os desenvolvedores dos pacotes apresentam as principais funções, argumentos e exemplos de uso. Basta pesquisar por <code>nome do pacote + R</code> no Google que você acha as informações oficiais com bastante facilidade. A documentação do pacote <a href="https://dplyr.tidyverse.org/"><code>{dplyr}</code></a> é facilmente encontrada. ]</p>
<p>Outro verbo/função similar ao <code>select()</code> é o <code>pull()</code>. Como o nome sugere, ele puxa as informações de uma coluna específica. Comparativamente:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lrpmg)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 1
    lrpmg
    &lt;dbl&gt;
 1 -0.335
 2 -0.351
 3 -0.380
 4 -0.414
 5 -0.445
 6 -0.497
 7 -0.467
 8 -0.506
 9 -0.522
10 -0.559
# ℹ 332 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(lrpmg) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="co"># usando o head() porque temos muitos elementos neste conjunto de daods</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3345476 -0.3513276 -0.3795177 -0.4142514 -0.4453354 -0.4970607</code></pre>
</div>
</div>
</section>
<section id="agrupando-informações-com-group_by" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="agrupando-informações-com-group_by"><span class="header-section-number">8.2</span> Agrupando informações com <code>group_by()</code></h2>
<p>A função <code>group_by()</code> facilita a computação de estatísticas descritivas por grupos. Agrupando os dados por país:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 6
# Groups:   country [18]
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77
 2 austria  1961     4.10    -6.43 -0.351    -9.61
 3 austria  1962     4.07    -6.41 -0.380    -9.46
 4 austria  1963     4.06    -6.37 -0.414    -9.34
 5 austria  1964     4.04    -6.32 -0.445    -9.24
 6 austria  1965     4.03    -6.29 -0.497    -9.12
 7 austria  1966     4.05    -6.25 -0.467    -9.02
 8 austria  1967     4.05    -6.23 -0.506    -8.93
 9 austria  1968     4.05    -6.21 -0.522    -8.85
10 austria  1969     4.05    -6.15 -0.559    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Não parece que mudou muita coisa, mas, se observamos a segunda linha do output, veremos que:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # Groups:   country [18]</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Isso significa que toda análise levará estes grupos em conta. Como vimos anteriormente com o <code>starwars</code>, é possível agrupar por mais de uma variável:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 6
# Groups:   country, year [342]
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77
 2 austria  1961     4.10    -6.43 -0.351    -9.61
 3 austria  1962     4.07    -6.41 -0.380    -9.46
 4 austria  1963     4.06    -6.37 -0.414    -9.34
 5 austria  1964     4.04    -6.32 -0.445    -9.24
 6 austria  1965     4.03    -6.29 -0.497    -9.12
 7 austria  1966     4.05    -6.25 -0.467    -9.02
 8 austria  1967     4.05    -6.23 -0.506    -8.93
 9 austria  1968     4.05    -6.21 -0.522    -8.85
10 austria  1969     4.05    -6.15 -0.559    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>E também é possível desagrupar, com a função <code>ungroup()</code>. Basicamente, o <code>group_by</code> “marca” a tabela para que os cálculos sejam feitos por grupo, e o <code>ungroup()</code> volta para que você trabalhe com a tabela como um todo.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 6
   country  year lgaspcar lincomep  lrpmg lcarpcap
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77
 2 austria  1961     4.10    -6.43 -0.351    -9.61
 3 austria  1962     4.07    -6.41 -0.380    -9.46
 4 austria  1963     4.06    -6.37 -0.414    -9.34
 5 austria  1964     4.04    -6.32 -0.445    -9.24
 6 austria  1965     4.03    -6.29 -0.497    -9.12
 7 austria  1966     4.05    -6.25 -0.467    -9.02
 8 austria  1967     4.05    -6.23 -0.506    -8.93
 9 austria  1968     4.05    -6.21 -0.522    -8.85
10 austria  1969     4.05    -6.15 -0.559    -8.79
# ℹ 332 more rows</code></pre>
</div>
</div>
</section>
<section id="resumir-estatísticas-com-summarise" class="level2 page-columns page-full" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="resumir-estatísticas-com-summarise"><span class="header-section-number">8.3</span> Resumir estatísticas com <code>summarise()</code></h2>
<p>Passado o básico, vamos avançar. Se eu quero computar o consume médio de gasolina por cada país, para todo o período, fazemos:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(lgaspcar))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 2
   country  `mean(lgaspcar)`
   &lt;chr&gt;               &lt;dbl&gt;
 1 austria              4.06
 2 belgium              3.92
 3 canada               4.86
 4 denmark              4.19
 5 france               3.82
 6 germany              3.89
 7 greece               4.88
 8 ireland              4.23
 9 italy                3.73
10 japan                4.70
11 netherla             4.08
12 norway               4.11
13 spain                4.06
14 sweden               4.01
15 switzerl             4.24
16 turkey               5.77
17 u.k.                 3.98
18 u.s.a.               4.82</code></pre>
</div>
</div>
<p>Como vimos com o <code>starwars</code>, é possível renomear o nome da coluna da média que apareceu anteriormente. Para isso:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gaspcar =</span> <span class="fu">mean</span>(lgaspcar))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 2
   country  mean_gaspcar
   &lt;chr&gt;           &lt;dbl&gt;
 1 austria          4.06
 2 belgium          3.92
 3 canada           4.86
 4 denmark          4.19
 5 france           3.82
 6 germany          3.89
 7 greece           4.88
 8 ireland          4.23
 9 italy            3.73
10 japan            4.70
11 netherla         4.08
12 norway           4.11
13 spain            4.06
14 sweden           4.01
15 switzerl         4.24
16 turkey           5.77
17 u.k.             3.98
18 u.s.a.           4.82</code></pre>
</div>
</div>
<p>Além disso, podemos filtrar as ocorrências para um país de interesse:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gaspcar =</span> <span class="fu">mean</span>(lgaspcar)) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"france"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  country mean_gaspcar
  &lt;chr&gt;          &lt;dbl&gt;
1 france          3.82</code></pre>
</div>
</div>
<p>Com a função <code>summarise()</code>, posso computar várias estatísticas de uma vez:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gaspcar =</span> <span class="fu">mean</span>(lgaspcar),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_gaspcar =</span> <span class="fu">sd</span>(lgaspcar),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_gaspcar =</span> <span class="fu">max</span>(lgaspcar),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_gaspcar =</span> <span class="fu">min</span>(lgaspcar))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 5
   country  mean_gaspcar sd_gaspcar max_gaspcar min_gaspcar
   &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
 1 austria          4.06     0.0693        4.20        3.92
 2 belgium          3.92     0.103         4.16        3.82
 3 canada           4.86     0.0262        4.90        4.81
 4 denmark          4.19     0.158         4.50        4.00
 5 france           3.82     0.0499        3.91        3.75
 6 germany          3.89     0.0239        3.93        3.85
 7 greece           4.88     0.255         5.38        4.48
 8 ireland          4.23     0.0437        4.33        4.16
 9 italy            3.73     0.220         4.05        3.38
10 japan            4.70     0.684         6.00        3.95
11 netherla         4.08     0.286         4.65        3.71
12 norway           4.11     0.123         4.44        3.96
13 spain            4.06     0.317         4.75        3.62
14 sweden           4.01     0.0364        4.07        3.91
15 switzerl         4.24     0.102         4.44        4.05
16 turkey           5.77     0.329         6.16        5.14
17 u.k.             3.98     0.0479        4.10        3.91
18 u.s.a.           4.82     0.0219        4.86        4.79</code></pre>
</div>
</div>
<p>E se quisermos “salvar” essas operações, basta atribuir a um objeto<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>:</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Lembrando que o sinal de atribuição mais apropriado é o <code>&lt;-</code>. Para fazê-lo, o atalho é <code>ALT -</code> (alt menos)</p></div></div><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>desc_gasoline <span class="ot">&lt;-</span> gasoline <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gaspcar =</span> <span class="fu">mean</span>(lgaspcar),</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_gaspcar =</span> <span class="fu">sd</span>(lgaspcar),</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_gaspcar =</span> <span class="fu">max</span>(lgaspcar),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_gaspcar =</span> <span class="fu">min</span>(lgaspcar))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Questão: qual país tem o maior consumo médio de gasolina?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>desc_gasoline <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">max</span>(mean_gaspcar) <span class="sc">==</span> mean_gaspcar)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  country mean_gaspcar sd_gaspcar max_gaspcar min_gaspcar
  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 turkey          5.77      0.329        6.16        5.14</code></pre>
</div>
</div>
<p>A função <code>max(mean_gaspcar)</code> calcula o maior valor da média de consumo de gasolina. Depois, fazemos uma comparação lógica para verificar se o valor naquela linha é igual ao valor máximo da coluna. Eu, particularmente, acho assim mais complicado de entender. Alternativametne, podemos usar:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>desc_gasoline <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(mean_gaspcar) <span class="co"># mais direto e reto!</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  country mean_gaspcar sd_gaspcar max_gaspcar min_gaspcar
  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 turkey          5.77      0.329        6.16        5.14</code></pre>
</div>
</div>
<p>Ou, também:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>desc_gasoline <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.max</span>(mean_gaspcar))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  country mean_gaspcar sd_gaspcar max_gaspcar min_gaspcar
  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 turkey          5.77      0.329        6.16        5.14</code></pre>
</div>
</div>
<p>A Túrquia tem o maior consumo médio de gasolina. E o valor mínimo?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>desc_gasoline <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(mean_gaspcar) <span class="co"># mais direto e reto!</span></span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  country mean_gaspcar sd_gaspcar max_gaspcar min_gaspcar
  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 italy           3.73      0.220        4.05        3.38</code></pre>
</div>
</div>
</section>
<section id="adicionando-colunas-com-o-mutate-e-transmute" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="adicionando-colunas-com-o-mutate-e-transmute"><span class="header-section-number">8.4</span> Adicionando colunas com o <code>mutate()</code> e <code>transmute()</code></h2>
<p>A função <code>mutate()</code> adiciona ou transforma uma coluna num conjunto de dados. Por exemplo:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">n</span>())</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 7
# Groups:   country [18]
   country  year lgaspcar lincomep  lrpmg lcarpcap `n()`
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77    19
 2 austria  1961     4.10    -6.43 -0.351    -9.61    19
 3 austria  1962     4.07    -6.41 -0.380    -9.46    19
 4 austria  1963     4.06    -6.37 -0.414    -9.34    19
 5 austria  1964     4.04    -6.32 -0.445    -9.24    19
 6 austria  1965     4.03    -6.29 -0.497    -9.12    19
 7 austria  1966     4.05    -6.25 -0.467    -9.02    19
 8 austria  1967     4.05    -6.23 -0.506    -8.93    19
 9 austria  1968     4.05    -6.21 -0.522    -8.85    19
10 austria  1969     4.05    -6.15 -0.559    -8.79    19
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Também é possível renomear a variável dentro da função <code>mutate()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 7
# Groups:   country [18]
   country  year lgaspcar lincomep  lrpmg lcarpcap count
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77    19
 2 austria  1961     4.10    -6.43 -0.351    -9.61    19
 3 austria  1962     4.07    -6.41 -0.380    -9.46    19
 4 austria  1963     4.06    -6.37 -0.414    -9.34    19
 5 austria  1964     4.04    -6.32 -0.445    -9.24    19
 6 austria  1965     4.03    -6.29 -0.497    -9.12    19
 7 austria  1966     4.05    -6.25 -0.467    -9.02    19
 8 austria  1967     4.05    -6.23 -0.506    -8.93    19
 9 austria  1968     4.05    -6.21 -0.522    -8.85    19
10 austria  1969     4.05    -6.15 -0.559    -8.79    19
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Ainda, é possível fazer qualquer outra operação:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">consumo_renda =</span> lgaspcar <span class="sc">/</span> lincomep)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 7
# Groups:   country [18]
   country  year lgaspcar lincomep  lrpmg lcarpcap consumo_renda
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
 1 austria  1960     4.17    -6.47 -0.335    -9.77        -0.645
 2 austria  1961     4.10    -6.43 -0.351    -9.61        -0.638
 3 austria  1962     4.07    -6.41 -0.380    -9.46        -0.636
 4 austria  1963     4.06    -6.37 -0.414    -9.34        -0.637
 5 austria  1964     4.04    -6.32 -0.445    -9.24        -0.639
 6 austria  1965     4.03    -6.29 -0.497    -9.12        -0.641
 7 austria  1966     4.05    -6.25 -0.467    -9.02        -0.647
 8 austria  1967     4.05    -6.23 -0.506    -8.93        -0.650
 9 austria  1968     4.05    -6.21 -0.522    -8.85        -0.652
10 austria  1969     4.05    -6.15 -0.559    -8.79        -0.658
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>A função <code>transmute()</code> opera da mesma forma que o mutate, mas retorna apenas a variável criada:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">consumo_renda =</span> lgaspcar <span class="sc">/</span> lincomep)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 342 × 2
# Groups:   country [18]
   country consumo_renda
   &lt;chr&gt;           &lt;dbl&gt;
 1 austria        -0.645
 2 austria        -0.638
 3 austria        -0.636
 4 austria        -0.637
 5 austria        -0.639
 6 austria        -0.641
 7 austria        -0.647
 8 austria        -0.650
 9 austria        -0.652
10 austria        -0.658
# ℹ 332 more rows</code></pre>
</div>
</div>
<p>Exemplo gráfico:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>gasoline <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lgaspcar, <span class="at">color =</span> country, <span class="at">group =</span> country)) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Consumo de Gasolina por Carro (log) ao longo do tempo"</span>,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ano"</span>,</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Log do consumo de gasolina por carro"</span>,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"País"</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02a-manipulacao-dados_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/arturdamiao\.github\.io\/2026-02-summer-intro-crime-analysis-R\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/02-conhecendo-o-R.html" class="pagination-link" aria-label="Conhecendo o `R`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conhecendo o <code>R</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/03-importando-dados.html" class="pagination-link" aria-label="Analisando dados da Secretaria de Segurança Pública">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analisando dados da Secretaria de Segurança Pública</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>